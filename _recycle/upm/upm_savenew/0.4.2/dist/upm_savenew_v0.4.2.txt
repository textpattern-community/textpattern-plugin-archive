# upm_savenew v.0.4.2
# "Save New" button for articles and forms.

# Mary Fredborg
# http://utterplush.com/txp-plugins/upm-savenew

# ..........................................................................
# A plugin for Textpattern
# http://textpattern.com/
#
# Adding Plugins to Your Textpattern Installation
# http://textpattern.net/wiki/index.php?title=Intermediate_Weblog_Model#Adding_Plugins_to_Your_Textpattern_Installation
# ..........................................................................

YToxMTp7czo0OiJuYW1lIjtzOjExOiJ1cG1fc2F2ZW5ldyI7czoxMToiZGVzY3JpcHRpb24i
O3M6NDE6IiJTYXZlIE5ldyIgYnV0dG9uIGZvciBhcnRpY2xlcyBhbmQgZm9ybXMuIjtzOjc6
InZlcnNpb24iO3M6NToiMC40LjIiO3M6NDoidHlwZSI7aToxO3M6NjoiYXV0aG9yIjtzOjEz
OiJNYXJ5IEZyZWRib3JnIjtzOjEwOiJhdXRob3JfdXJpIjtzOjQ1OiJodHRwOi8vdXR0ZXJw
bHVzaC5jb20vdHhwLXBsdWdpbnMvdXBtLXNhdmVuZXciO3M6NDoiY29kZSI7czoxOTc1OiJp
ZiAodHhwaW50ZXJmYWNlID09ICdhZG1pbicpCgl7CgkJLy8gbGluayB0byBqYXZhc2NyaXB0
CgkJYWRkX3ByaXZzKCd1cG1fc2F2ZW5ld19qc19saW5rX2xvYWQnLCAnMSwyLDMsNCw1LDYn
KTsKCQlyZWdpc3Rlcl9jYWxsYmFjaygndXBtX3NhdmVuZXdfanNfbGlua19sb2FkJywgJ2Fy
dGljbGUnLCAnZWRpdCcsIDEpOwoJCXJlZ2lzdGVyX2NhbGxiYWNrKCd1cG1fc2F2ZW5ld19q
c19saW5rX2xvYWQnLCAnZm9ybScsICcnLCAxKTsKCgkJLy8gbG9hZCBqYXZhc2NyaXB0CgkJ
YWRkX3ByaXZzKCd1cG1fc2F2ZW5ld19qcycsICcxLDIsMyw0LDUsNicpOwoJCXJlZ2lzdGVy
X2NhbGxiYWNrKCd1cG1fc2F2ZW5ld19qcycsICd1cG1fc2F2ZW5ld19qcycsICcnLCAxKTsK
CX0KCi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0KCglmdW5jdGlvbiB1cG1fc2F2ZW5ld19qc19saW5rX2xvYWQoKQoJ
ewoJCW9iX3N0YXJ0KCd1cG1fc2F2ZW5ld19qc19saW5rJyk7Cgl9CgoJZnVuY3Rpb24gdXBt
X3NhdmVuZXdfanNfbGluaygkYnVmZmVyKQoJewoJCSRmaW5kID0gJzwvaGVhZD4nOwoJCSRy
ZXBsYWNlID0gbi5uLnQudC4nPHNjcmlwdCB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiIHNyYz0i
aW5kZXgucGhwP2V2ZW50PXVwbV9zYXZlbmV3X2pzIj48L3NjcmlwdD4nLm4udDsKCgkJcmV0
dXJuIHN0cl9yZXBsYWNlKCRmaW5kLCAkcmVwbGFjZS4kZmluZCwgJGJ1ZmZlcik7Cgl9Cgov
LyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tCgoJZnVuY3Rpb24gdXBtX3NhdmVuZXdfanMoKQoJewoJCXdoaWxlIChAb2Jf
ZW5kX2NsZWFuKCkpOwoKCQkkc2F2ZV9uZXcgPSBnVHh0KCdzYXZlX25ldycpOwoKCQloZWFk
ZXIoIkNvbnRlbnQtdHlwZTogdGV4dC9qYXZhc2NyaXB0Iik7CgoJCWVjaG8gPDw8anMKLyoK
dXBtX3NhdmVuZXcKKi8KCgkkKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpIHsKCQkvLyBj
cmVhdGUgbmV3IGFydGljbGUgc3VibWl0IGJ1dHRvbgoJCSQoJyNwYWdlLWFydGljbGUgaW5w
dXRbbmFtZT0ic2F2ZSJdJykuCgkJCWFmdGVyKCcgPGlucHV0IHR5cGU9InN1Ym1pdCIgbmFt
ZT0icHVibGlzaCIgdmFsdWU9IiRzYXZlX25ldyIgY2xhc3M9InB1Ymxpc2giIC8+Jyk7CgoJ
CS8vIGFydGljbGUgc2F2ZSBuZXcgYnV0dG9uCgkJJCgnI3BhZ2UtYXJ0aWNsZSBpbnB1dFtu
YW1lPSJzYXZlIl0gKyBpbnB1dFtuYW1lPSJwdWJsaXNoIl0nKS4KCQkJLy8gb25jbGljay4u
LgoJCQljbGljayhmdW5jdGlvbigpewoJCQkJLy8gY2hlY2sgcmVzZXQgdGltZSBjaGVja2Jv
eAoJCQkJJCgnI3Jlc2V0X3RpbWUnKS5hdHRyKHsKCQkJCQluYW1lOiAncHVibGlzaF9ub3cn
LAoJCQkJCWNoZWNrZWQ6IHRydWUKCQkJCX0pOwoKCQkJCS8vIGVtcHR5IFVSTC1vbmx5IHRp
dGxlCgkJCQkkKCcjdXJsLXRpdGxlJykuYXR0cigndmFsdWUnLCAnJyk7CgkJCX0pOwoKCQkv
LyBjcmVhdGUgbmV3IGZvcm0gc3VibWl0IGJ1dHRvbgoJCSQoJyNwYWdlLWZvcm0gaW5wdXRb
bmFtZT0ic2F2ZSJdJykuCgkJCWFmdGVyKCcgPGlucHV0IHR5cGU9InN1Ym1pdCIgbmFtZT0i
c2F2ZW5ldyIgdmFsdWU9IiRzYXZlX25ldyIgY2xhc3M9InB1Ymxpc2giIC8+Jyk7CgoJCS8v
IGZvcm1zIHNhdmUgbmV3IGJ1dHRvbgoJCSQoJyNwYWdlLWZvcm0gaW5wdXRbbmFtZT0ic2F2
ZSJdICsgaW5wdXRbbmFtZT0ic2F2ZW5ldyJdJykuCgkJCS8vIG9uY2xpY2suLi4KCQkJY2xp
Y2soZnVuY3Rpb24oKXsKCQkJCS8vIGNoYW5nZSBmb3JtIG5hbWUgZnJvbSBvcmlnaW5hbCB0
byBvcmlnaW5hbF9jb3B5CgkJCQkkKCdpbnB1dFtuYW1lPSJuYW1lIl0nKS5hdHRyKCd2YWx1
ZScsICQoJ2lucHV0W25hbWU9Im5hbWUiXScpLmF0dHIoJ3ZhbHVlJykgKyAnX2NvcHknKTsK
CQkJfSk7Cgl9KTsKCmpzOwoJCWV4aXQoMCk7Cgl9IjtzOjQ6ImhlbHAiO3M6MzAxOiJoMS4g
dXBtX3NhdmVuZXcKCk9uY2UgaW5zdGFsbGVkIGFuZCBhY3RpdmF0ZWQsIHlvdSdyZSByZWFk
eSB0byBnby4KClRoaXMgcGx1Z2luIHN0YXJ0ZWQgYXMgImEgaGFjayBjcmVhdGVkIGJ5ICpn
cmFwZWljZTkyNSoiOmh0dHA6Ly9mb3J1bS50ZXh0cGF0dGVybi5jb20vdmlld3RvcGljLnBo
cD9pZD0yNTg2IG9mIHRoZSBUZXh0cGF0dGVybiBmb3J1bS4gSSBjb252ZXJ0ZWQgaXQgaW50
byBhbiBhZG1pbi1zaWRlIHBsdWdpbiwgYW5kIGV4dGVuZGVkIGl0IHRvIGluY2x1ZGUgYSAi
U2F2ZSBOZXciIGJ1dHRvbiBmb3IgZm9ybXMuIjtzOjg6ImhlbHBfcmF3IjtzOjMwMToiaDEu
IHVwbV9zYXZlbmV3CgpPbmNlIGluc3RhbGxlZCBhbmQgYWN0aXZhdGVkLCB5b3UncmUgcmVh
ZHkgdG8gZ28uCgpUaGlzIHBsdWdpbiBzdGFydGVkIGFzICJhIGhhY2sgY3JlYXRlZCBieSAq
Z3JhcGVpY2U5MjUqIjpodHRwOi8vZm9ydW0udGV4dHBhdHRlcm4uY29tL3ZpZXd0b3BpYy5w
aHA/aWQ9MjU4NiBvZiB0aGUgVGV4dHBhdHRlcm4gZm9ydW0uIEkgY29udmVydGVkIGl0IGlu
dG8gYW4gYWRtaW4tc2lkZSBwbHVnaW4sIGFuZCBleHRlbmRlZCBpdCB0byBpbmNsdWRlIGEg
IlNhdmUgTmV3IiBidXR0b24gZm9yIGZvcm1zLiI7czoxNToiYWxsb3dfaHRtbF9oZWxwIjtp
OjA7czozOiJtZDUiO3M6MzI6IjQxZWQzMTQzNTM0MzgxZGZkNmEwZjYzZDZjNjk2YTk2Ijt9